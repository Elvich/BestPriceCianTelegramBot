# üè† BestPriceCianTelegramBot

–¢–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–≤–∞—Ä—Ç–∏—Ä –Ω–∏–∂–µ —Ä—ã–Ω–∫–∞ –Ω–∞ –¶–∏–∞–Ω.

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- –ü–∞—Ä—Å–∏–Ω–≥ –æ–±—ä—è–≤–ª–µ–Ω–∏–π —Å Cian.ru –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Å—Å—ã–ª–∫–∞–º.
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π (staging/production).
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –æ –Ω–æ–≤—ã—Ö –≤—ã–≥–æ–¥–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PostgreSQL –∏ SQLite.

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/Elvich/BestPriceCianTelegramBot.git
cd BestPriceCianTelegramBot
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ:
```bash
cp .env.example .env
nano .env
```
–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∂–∏—Ç–µ:
- `BOT_TOKEN`: –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞.
- `CIAN_URLS`: –°—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–∏—Å–∫ –¶–∏–∞–Ω (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é).
- `DATABASE_URL`: –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é SQLite: `sqlite+aiosqlite:///cian_bot.db`).

### 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
python -m core.database.init_db
```
*–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:* `drop` (—É–¥–∞–ª–∏—Ç—å), `recreate` (–ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å).

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (–ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏)
–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª–∞—Ö:

**1. –ë–æ—Ç (–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å):**
```bash
python services/bot/main.py
```

**2. –ü–∞—Ä—Å–µ—Ä (–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö):**
```bash
python services/parser/main.py
```

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose
–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–ë–î, –ü–∞—Ä—Å–µ—Ä, –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä, –ë–æ—Ç):
```bash
docker-compose up --build -d
```

## üèó –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- `core/`: –û–±—â–∏–π –∫–æ–¥ (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –º–æ–¥–µ–ª–∏ –ë–î).
- `services/bot/`: –°–µ—Ä–≤–∏—Å –¢–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞.
- `services/parser/`: –°–µ—Ä–≤–∏—Å –ø–∞—Ä—Å–∏–Ω–≥–∞ –¶–∏–∞–Ω.
- `services/analyzer/`: –°–µ—Ä–≤–∏—Å –∞–Ω–∞–ª–∏–∑–∞ —Ü–µ–Ω (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è).
- `scripts/`: –£—Ç–∏–ª–∏—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.
